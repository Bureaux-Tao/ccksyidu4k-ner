/Users/Bureaux/miniconda3/envs/tf_v1/bin/python "/Users/Bureaux/Library/Application Support/JetBrains/Toolbox/apps/PyCharm-P/ch-0/213.5744.248/PyCharm.app/Contents/plugins/python/helpers/pydev/pydevconsole.py" --mode=client --port=56869
import sys; print('Python %s on %s' % (sys.version, sys.platform))
sys.path.extend(['/Volumes/Riesling/TRAIN/AI-base/src/albert_tiny'])
Python 3.7.10 (default, Feb 26 2021, 10:16:00)
Type 'copyright', 'credits' or 'license' for more information
IPython 7.22.0 -- An enhanced Interactive Python. Type '?' for help.
PyDev console: using IPython 7.22.0
Python 3.7.10 (default, Feb 26 2021, 10:16:00)
[Clang 10.0.0 ] on darwin
runfile('/Volumes/Riesling/TRAIN/AI-base/src/albert_tiny/train.py', wdir='/Volumes/Riesling/TRAIN/AI-base/src/albert_tiny')
Using TensorFlow backend.
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
WARNING:tensorflow:From /Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.
WARNING:tensorflow:From /Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4185: The name tf.truncated_normal is deprecated. Please use tf.random.truncated_normal instead.
WARNING:tensorflow:From /Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.
WARNING:tensorflow:From /Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:174: The name tf.get_default_session is deprecated. Please use tf.compat.v1.get_default_session instead.
WARNING:tensorflow:From /Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:181: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.
WARNING:tensorflow:From /Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:2974: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
Input-Token (InputLayer)        (None, None)         0
__________________________________________________________________________________________________
Input-Segment (InputLayer)      (None, None)         0
__________________________________________________________________________________________________
Embedding-Token (Embedding)     (None, None, 312)    6591936     Input-Token[0][0]
__________________________________________________________________________________________________
Embedding-Segment (Embedding)   (None, None, 312)    624         Input-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Token-Segment (Add)   (None, None, 312)    0           Embedding-Token[0][0]
                                                                 Embedding-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Position (PositionEmb (None, None, 312)    159744      Embedding-Token-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Norm (LayerNormalizat (None, None, 312)    624         Embedding-Position[0][0]
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    390624      Embedding-Norm[0][0]
                                                                 Embedding-Norm[0][0]
                                                                 Embedding-Norm[0][0]
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-FeedForward-Norm[2][0
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    0           Embedding-Norm[0][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    624         Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-FeedForward (FeedFo (None, None, 312)    780312      Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-FeedForward-Add (Ad (None, None, 312)    0           Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[0][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[1][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[2][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[3][0]
__________________________________________________________________________________________________
Transformer-FeedForward-Norm (L (None, None, 312)    624         Transformer-FeedForward-Add[0][0]
                                                                 Transformer-FeedForward-Add[1][0]
                                                                 Transformer-FeedForward-Add[2][0]
                                                                 Transformer-FeedForward-Add[3][0]
__________________________________________________________________________________________________
bidirectional_1 (Bidirectional) (None, None, 64)     88320       Transformer-FeedForward-Norm[3][0
__________________________________________________________________________________________________
time_distributed_1 (TimeDistrib (None, None, 13)     845         bidirectional_1[0][0]
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, None, 13)     0           time_distributed_1[0][0]
__________________________________________________________________________________________________
conditional_random_field_1 (Con (None, None, 13)     169         dropout_1[0][0]
==================================================================================================
Total params: 8,014,446
Trainable params: 8,014,446
Non-trainable params: 0
__________________________________________________________________________________________________
WARNING:tensorflow:From /Users/Bureaux/miniconda3/envs/tf_v1/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.
	Train start!
Epoch 1/100
 - 770s - loss: 49.1390 - sparse_accuracy: 0.6018 - val_loss: 13.4391 - val_sparse_accuracy: 0.7898
Epoch 2/100
 - 753s - loss: 10.2020 - sparse_accuracy: 0.7653 - val_loss: 5.3708 - val_sparse_accuracy: 0.8641
Epoch 3/100
 - 733s - loss: 5.7223 - sparse_accuracy: 0.8205 - val_loss: 4.1568 - val_sparse_accuracy: 0.8634
Epoch 4/100
 - 731s - loss: 4.5032 - sparse_accuracy: 0.8424 - val_loss: 3.4879 - val_sparse_accuracy: 0.8683
Epoch 5/100
 - 711s - loss: 3.7764 - sparse_accuracy: 0.8527 - val_loss: 3.6472 - val_sparse_accuracy: 0.8715
Epoch 6/100
 - 749s - loss: 3.4729 - sparse_accuracy: 0.8677 - val_loss: 3.1412 - val_sparse_accuracy: 0.8698
Epoch 7/100
 - 756s - loss: 3.3456 - sparse_accuracy: 0.8723 - val_loss: 3.4226 - val_sparse_accuracy: 0.8793
Epoch 8/100
 - 739s - loss: 2.8675 - sparse_accuracy: 0.8863 - val_loss: 2.9879 - val_sparse_accuracy: 0.8660
Epoch 9/100
 - 755s - loss: 2.2406 - sparse_accuracy: 0.8996 - val_loss: 3.2420 - val_sparse_accuracy: 0.8994
Epoch 10/100
 - 745s - loss: 1.9016 - sparse_accuracy: 0.9109 - val_loss: 3.1923 - val_sparse_accuracy: 0.9048
Epoch 11/100
 - 724s - loss: 1.5433 - sparse_accuracy: 0.9205 - val_loss: 3.4541 - val_sparse_accuracy: 0.9165
Epoch 12/100
 - 738s - loss: 1.2031 - sparse_accuracy: 0.9268 - val_loss: 3.4025 - val_sparse_accuracy: 0.9178
Epoch 13/100
 - 743s - loss: 0.9962 - sparse_accuracy: 0.9335 - val_loss: 3.5184 - val_sparse_accuracy: 0.9213
Epoch 14/100
 - 731s - loss: 0.8360 - sparse_accuracy: 0.9382 - val_loss: 3.7192 - val_sparse_accuracy: 0.9232
Epoch 15/100
 - 719s - loss: 0.7911 - sparse_accuracy: 0.9422 - val_loss: 3.7624 - val_sparse_accuracy: 0.9226
Epoch 16/100
 - 756s - loss: 0.7482 - sparse_accuracy: 0.9437 - val_loss: 3.9458 - val_sparse_accuracy: 0.9279
Epoch 17/100
 - 764s - loss: 0.6849 - sparse_accuracy: 0.9473 - val_loss: 4.0747 - val_sparse_accuracy: 0.9282
Epoch 18/100
 - 724s - loss: 0.6736 - sparse_accuracy: 0.9475 - val_loss: 4.1747 - val_sparse_accuracy: 0.9283
Epoch 19/100
 - 712s - loss: 0.6591 - sparse_accuracy: 0.9492 - val_loss: 4.2813 - val_sparse_accuracy: 0.9280
Epoch 20/100
 - 719s - loss: 0.6089 - sparse_accuracy: 0.9505 - val_loss: 4.2637 - val_sparse_accuracy: 0.9312
Epoch 21/100
 - 685s - loss: 0.5868 - sparse_accuracy: 0.9513 - val_loss: 4.4036 - val_sparse_accuracy: 0.9295
Epoch 22/100
 - 727s - loss: 0.5510 - sparse_accuracy: 0.9530 - val_loss: 4.5013 - val_sparse_accuracy: 0.9303
Epoch 23/100
 - 777s - loss: 0.5480 - sparse_accuracy: 0.9554 - val_loss: 4.4893 - val_sparse_accuracy: 0.9330
Epoch 24/100
 - 718s - loss: 0.5393 - sparse_accuracy: 0.9557 - val_loss: 4.6317 - val_sparse_accuracy: 0.9328
Epoch 25/100
 - 703s - loss: 0.5271 - sparse_accuracy: 0.9559 - val_loss: 4.7771 - val_sparse_accuracy: 0.9301
Epoch 26/100
 - 686s - loss: 0.4998 - sparse_accuracy: 0.9567 - val_loss: 4.7434 - val_sparse_accuracy: 0.9345
Epoch 27/100
 - 719s - loss: 0.4965 - sparse_accuracy: 0.9574 - val_loss: 5.0567 - val_sparse_accuracy: 0.9342
Epoch 28/100
 - 696s - loss: 0.4825 - sparse_accuracy: 0.9574 - val_loss: 4.8120 - val_sparse_accuracy: 0.9354
Epoch 29/100
 - 734s - loss: 0.4745 - sparse_accuracy: 0.9589 - val_loss: 4.8945 - val_sparse_accuracy: 0.9342
Epoch 30/100
 - 723s - loss: 0.4671 - sparse_accuracy: 0.9591 - val_loss: 4.8116 - val_sparse_accuracy: 0.9308
Epoch 31/100
 - 759s - loss: 0.5044 - sparse_accuracy: 0.9569 - val_loss: 4.9262 - val_sparse_accuracy: 0.9340
Epoch 32/100
 - 783s - loss: 0.4854 - sparse_accuracy: 0.9577 - val_loss: 4.8675 - val_sparse_accuracy: 0.9367
Epoch 33/100
 - 790s - loss: 0.4582 - sparse_accuracy: 0.9592 - val_loss: 5.1912 - val_sparse_accuracy: 0.9368
Epoch 34/100
 - 781s - loss: 0.4524 - sparse_accuracy: 0.9609 - val_loss: 5.1500 - val_sparse_accuracy: 0.9358
Epoch 35/100
 - 735s - loss: 0.5254 - sparse_accuracy: 0.9581 - val_loss: 4.5702 - val_sparse_accuracy: 0.9313
Epoch 36/100
 - 727s - loss: 0.4671 - sparse_accuracy: 0.9573 - val_loss: 4.9727 - val_sparse_accuracy: 0.9318
Epoch 37/100
 - 725s - loss: 0.4907 - sparse_accuracy: 0.9572 - val_loss: 5.0211 - val_sparse_accuracy: 0.9309
Epoch 38/100
 - 716s - loss: 0.4637 - sparse_accuracy: 0.9578 - val_loss: 4.7498 - val_sparse_accuracy: 0.9322
Epoch 39/100
 - 726s - loss: 0.4224 - sparse_accuracy: 0.9587 - val_loss: 5.1540 - val_sparse_accuracy: 0.9346
Epoch 40/100
 - 723s - loss: 0.4416 - sparse_accuracy: 0.9590 - val_loss: 5.1426 - val_sparse_accuracy: 0.9326
Epoch 41/100
 - 715s - loss: 0.4751 - sparse_accuracy: 0.9565 - val_loss: 5.1990 - val_sparse_accuracy: 0.9327
Epoch 42/100
 - 705s - loss: 0.4503 - sparse_accuracy: 0.9558 - val_loss: 5.2695 - val_sparse_accuracy: 0.9333
Epoch 43/100
 - 728s - loss: 0.3920 - sparse_accuracy: 0.9609 - val_loss: 5.6035 - val_sparse_accuracy: 0.9349
Epoch 00043: early stopping
	Train end!
